# Implementation Plan: Docusaurus Site Initialization & Configuration

**Branch**: `1-docusaurus-setup` | **Date**: 2025-11-28 | **Spec**: [specs/1-docusaurus-setup/spec.md](spec.md)

**Input**: Feature specification from `/specs/1-docusaurus-setup/spec.md`

---

## Summary

Initialize a production-ready Docusaurus 3.x site with TypeScript and pnpm, configured for Physical AI & Robotics Textbook with custom dark/light theme, essential plugins (search, sitemap, RSS), 4-module navigation structure, and automated GitHub Pages deployment via GitHub Actions. Deliverable includes live book skeleton on GitHub Pages ready for Phase 2 content creation.

---

## Technical Context

**Language/Version**: Node.js 18+ LTS (required for Docusaurus 3.x)

**Primary Dependencies**:
- Docusaurus 3.x (core)
- TypeScript 5.x (strict mode)
- pnpm 8+ (package manager)
- @docusaurus/preset-classic (theme & layouts)
- @docusaurus/plugin-search-local (search)
- @docusaurus/plugin-sitemap (SEO)
- @docusaurus/plugin-ideal-image (image optimization)

**Storage**: Static site generation (no database required for this phase)

**Testing**: Manual browser testing + automated Lighthouse performance validation (non-automated, human-verified in Phase 5)

**Target Platform**: Web (responsive, tested on Chrome, Firefox, Safari, Edge; mobile viewports 320px+)

**Project Type**: Static site generator (single output: `build/` directory)

**Performance Goals**:
- Page load: <3 seconds on 4G connection
- Lighthouse Performance score: â‰¥90
- Build time: <60 seconds

**Constraints**:
- No custom webpack configuration (use Docusaurus defaults)
- No ejected setup (maintain upgrade path)
- Environment variables for sensitive configuration
- GitHub Pages CNAME for custom domain (if applicable)

**Scale/Scope**:
- 4 modules Ã— ~9 lessons each = ~36-40 pages at launch
- Expandable to 100+ pages in Phase 2

---

## Constitution Check

**Gate: Must pass before proceeding to implementation**

| Principle | Requirement | Status | Notes |
|-----------|-------------|--------|-------|
| **I. Hackathon-Speed Development** | Base requirements prioritized, MVP focus | âœ… PASS | Phase 1 scope limited to core Docusaurus setup + deployment; plugins deferred if timeline threatens |
| **II. Content Accuracy & Verification** | No hallucinated APIs; verify against official docs | âœ… PASS | Using official Docusaurus 3.x docs; Vercel recommended deployment docs; no custom plugin implementations |
| **III. Technology Stack Adherence** | Docusaurus, TypeScript, pnpm mandatory; GitHub Pages deployment | âœ… PASS | All primary stack requirements met; no substitutions |
| **IV. Educational Structure** | Clear learning outcomes per module | â¸ï¸ DEFERRED | Module structure defined in spec; content creation in Phase 2 |
| **V. RAG Chatbot Excellence** | N/A (Phase 3) | â¸ï¸ DEFERRED | Out of scope for Docusaurus initialization |
| **VI. Spec-Driven Development** | Follow SDD workflow with ADRs | âœ… PASS | This plan document is spec-driven artifact; architecture decisions documented below |
| **VII. Bonus Feature Strategy** | Base requirements first | âœ… PASS | Bonus features (auth, personalization, translation) deferred to Phase 4 |
| **VIII. Deployment & Performance** | GitHub Pages live, Lighthouse >90, <3s load, mobile-responsive | âœ… PASS | GitHub Actions automation included; performance targets embedded in Phase 1 tasks |

**Gate Result**: âœ… **PASS** - Proceed to Phase 0 Research

---

## Project Structure

### Documentation (this feature)

```
specs/1-docusaurus-setup/
â”œâ”€â”€ spec.md                           # Feature specification
â”œâ”€â”€ plan.md                           # This file (implementation plan)
â”œâ”€â”€ research.md                       # Phase 0 research findings (generated below)
â”œâ”€â”€ data-model.md                     # Phase 1 data model
â”œâ”€â”€ quickstart.md                     # Phase 1 developer quickstart
â”œâ”€â”€ contracts/
â”‚   â””â”€â”€ config-schema.md              # Docusaurus config structure
â”œâ”€â”€ checklists/
â”‚   â””â”€â”€ requirements.md               # Spec quality validation
â””â”€â”€ tasks.md                          # Phase 2 output (generated by /sp.tasks)
```

### Source Code (repository root)

```
.
â”œâ”€â”€ docusaurus.config.js              # Primary Docusaurus configuration
â”œâ”€â”€ sidebars.js                       # Navigation structure (4 modules + docs)
â”œâ”€â”€ package.json                      # Dependencies (TypeScript, pnpm, Docusaurus)
â”œâ”€â”€ pnpm-lock.yaml                    # pnpm lock file (strict versions)
â”‚
â”œâ”€â”€ docs/                             # Content directory
â”‚   â”œâ”€â”€ intro.md                      # Book introduction
â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”œâ”€â”€ ros2/
â”‚   â”‚   â”‚   â”œâ”€â”€ intro.md
â”‚   â”‚   â”‚   â””â”€â”€ lessons/              # Populated in Phase 2
â”‚   â”‚   â”œâ”€â”€ gazebo/
â”‚   â”‚   â”‚   â”œâ”€â”€ intro.md
â”‚   â”‚   â”‚   â””â”€â”€ lessons/
â”‚   â”‚   â”œâ”€â”€ isaac/
â”‚   â”‚   â”‚   â”œâ”€â”€ intro.md
â”‚   â”‚   â”‚   â””â”€â”€ lessons/
â”‚   â”‚   â””â”€â”€ vla/
â”‚   â”‚       â”œâ”€â”€ intro.md
â”‚   â”‚       â””â”€â”€ lessons/
â”‚   â””â”€â”€ static/                       # Images, assets (populated in Phase 2)
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ custom.css                # Custom theme overrides
â”‚   â”œâ”€â”€ components/                   # Future React components (future phases)
â”‚   â””â”€â”€ pages/                        # Custom pages (e.g., landing)
â”‚
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ build-and-deploy.yml      # GitHub Actions deployment automation
â”‚
â”œâ”€â”€ .env.example                      # Environment variables template
â”œâ”€â”€ .env.local                        # Local dev config (git-ignored)
â”œâ”€â”€ .gitignore                        # Git exclusions (node_modules, build, .env)
â”‚
â””â”€â”€ build/                            # Generated static site (git-ignored)
    â”œâ”€â”€ index.html
    â”œâ”€â”€ sitemap.xml
    â””â”€â”€ [compiled site]
```

**Structure Decision**: Single-project static site. No backend/frontend separation needed for Phase 1. All configuration in root; content in `docs/` directory following Docusaurus convention.

---

## Complexity Tracking

No constitution violations requiring justification. All requirements met within standard Docusaurus setup scope.

---

## Phases & Architecture

### Phase 0: Research & Decision Documentation

**Deliverable**: `research.md` documenting:
1. Docusaurus 3.x vs earlier versions (why 3.x chosen)
2. Plugin selection rationale (search, sitemap, RSS)
3. Theme customization approach (preset vs custom)
4. GitHub Pages deployment automation strategy
5. pnpm vs npm comparison
6. TypeScript strict mode implications

**Key Research Questions**:
- âœ… **Docusaurus version**: Use 3.x (latest, LTS support, modern tooling)
- âœ… **Search plugin**: `@docusaurus/plugin-search-local` (no external dependencies, works offline for dev)
- âœ… **Theme approach**: Extend `@docusaurus/preset-classic` (maintains upgrade path, less maintenance)
- âœ… **Deployment**: GitHub Actions with automatic deployment on main branch push (eliminates manual steps)
- âœ… **Package manager**: pnpm for stricter dependency resolution
- âœ… **TypeScript**: Strict mode enabled (catches errors early)

---

### Phase 1: Design & Core Setup

#### 1.1 Data Model (`data-model.md`)

**Docusaurus Configuration Entities**:

```yaml
SiteConfig:
  title: "Physical AI & Humanoid Robotics Textbook"
  description: "Learn embodied intelligence, ROS 2, simulation, and vision-language models"
  url: "https://github.com/<user>/<repo>/github.io"  # GitHub Pages URL
  baseUrl: "/"
  favicon: "img/favicon.ico"
  organizationName: "<github-user>"
  projectName: "<repo-name>"

Theme:
  colorMode:
    defaultMode: "light"
    disableSwitch: false
    respectPrefersColorScheme: true
  navbar:
    title: "Physical AI Textbook"
    logo: "img/logo.svg"
    items:
      - label: "Modules"
        position: "left"
        items:
          - label: "ROS 2"
            to: "modules/ros2"
          - label: "Gazebo"
            to: "modules/gazebo"
          - label: "NVIDIA Isaac"
            to: "modules/isaac"
          - label: "Vision-Language-Action"
            to: "modules/vla"
      - label: "GitHub"
        href: "https://github.com/..."
        position: "right"

Plugins:
  - search-local:
      hashed: true
      indexDocs: true
      indexPages: false
      language: "en"
  - sitemap:
      changefreq: "weekly"
      priority: 0.5
  - ideal-image: {}

Navigation (sidebars.js):
  - type: "doc"
    id: "intro"
    label: "Introduction"
  - type: "category"
    label: "Module 1: ROS 2"
    items: [ros2-lesson-1, ros2-lesson-2, ...]
  - type: "category"
    label: "Module 2: Gazebo"
    items: [gazebo-lesson-1, gazebo-lesson-2, ...]
  - type: "category"
    label: "Module 3: NVIDIA Isaac"
    items: [isaac-lesson-1, isaac-lesson-2, ...]
  - type: "category"
    label: "Module 4: Vision-Language-Action"
    items: [vla-lesson-1, vla-lesson-2, ...]
```

#### 1.2 Contracts (`contracts/config-schema.md`)

**docusaurus.config.js Structure**:
```javascript
// Core presets
module.exports = {
  title: string,
  tagline: string,
  url: string,
  baseUrl: string,
  favicon: string,
  organizationName: string,
  projectName: string,
  onBrokenLinks: "throw" | "warn" | "ignore",
  onBrokenMarkdownLinks: "warn",
  i18n: { defaultLocale: "en", locales: ["en"] },

  presets: [
    [
      "@docusaurus/preset-classic",
      {
        docs: { /* docs config */ },
        blog: { /* blog config */ },
        theme: { customCss: [] }
      }
    ]
  ],

  plugins: [
    /* plugin configs */
  ],

  themeConfig: {
    colorMode: { /* dark/light mode */ },
    navbar: { /* navbar items */ },
    footer: { /* footer links */ },
    prism: { /* syntax highlighting */ }
  }
}
```

**sidebars.js Structure**:
```javascript
module.exports = {
  defaultSidebar: [
    "intro",
    {
      type: "category",
      label: "Module 1: ROS 2",
      items: [ /* lesson items */ ]
    },
    // ... repeat for 3 more modules
  ]
}
```

#### 1.3 Quickstart (`quickstart.md`)

Developer steps to get from zero to running local dev server:

```bash
# 1. Install dependencies
pnpm install

# 2. Start development server
pnpm start

# 3. Open browser to http://localhost:3000

# 4. Make changes to docs/ â†’ see hot-reload

# 5. Build for production
pnpm build

# 6. Preview production build locally
pnpm serve
```

#### 1.4 Agent Context Update

Update Claude Code context with:
- Docusaurus 3.x configuration specifics
- TypeScript strict mode requirements
- pnpm workspace patterns
- GitHub Pages deployment patterns
- Search plugin configuration

---

### Phase 2: Implementation Tasks

**Generated by `/sp.tasks` command** (not in this plan). Will include:

1. Initialize Docusaurus project with `docusaurus-initializer` skill
2. Configure TypeScript (tsconfig.json, strict mode)
3. Customize theme (colors, fonts, dark mode)
4. Install & configure plugins (search, sitemap, RSS)
5. Create 4-module sidebar structure
6. Create placeholder lesson files
7. Configure GitHub Actions workflow
8. Set up environment variables (.env)
9. Deploy to GitHub Pages
10. Validate Lighthouse scores
11. Test mobile responsiveness
12. Document quickstart for developers

---

## Key Architecture Decisions

### Decision 1: Docusaurus 3.x Over Earlier Versions
- **Rationale**: Latest stable version with modern tooling, TypeScript-first, active maintenance
- **Alternatives Considered**: Docusaurus 2.x (stable but older), custom Next.js (overkill for static book)
- **Tradeoff**: Requires Node.js 18+; ensures future upgrade path

### Decision 2: @docusaurus/plugin-search-local Over Algolia
- **Rationale**: No external API dependencies, works offline, suitable for hackathon timeline
- **Alternatives Considered**: Algolia (cloud-hosted but requires free tier signup), custom implementation
- **Tradeoff**: Client-side search (smaller scale), adequate for <1000 pages

### Decision 3: GitHub Actions Automation
- **Rationale**: Free, integrated with GitHub, no manual deployment steps, reliable CI/CD
- **Alternatives Considered**: Manual deployment, Vercel (works but adds external dependency)
- **Tradeoff**: Locked to GitHub (acceptable for this project)

### Decision 4: TypeScript Strict Mode
- **Rationale**: Catches configuration errors early; prepares for Phase 3 chatbot integration
- **Alternatives Considered**: JavaScript (simpler but error-prone)
- **Tradeoff**: Slightly steeper learning curve (acceptable for experienced developers)

### Decision 5: Extend @docusaurus/preset-classic vs Custom Theme
- **Rationale**: Maintains upgrade path, less maintenance burden, proven patterns
- **Alternatives Considered**: Custom theme from scratch (more control but 3x more effort)
- **Tradeoff**: Limited customization (acceptableâ€”physical AI theme can be impressive with CSS alone)

---

## Risk Mitigation

| Risk | Impact | Mitigation |
|------|--------|-----------|
| **pnpm dependency conflicts** | ðŸ”´ High | Lock exact versions in pnpm-lock.yaml; test on clean install |
| **GitHub Actions deployment fails** | ðŸ”´ High | Test workflow locally in Phase 1; have manual fallback documented |
| **Lighthouse score <90** | ðŸŸ¡ Medium | Image optimization, bundle analysis; defer non-critical plugins |
| **Mobile responsiveness issues** | ðŸŸ¡ Medium | Test on real devices; use Docusaurus mobile-first default styles |
| **TypeScript configuration errors** | ðŸŸ¡ Medium | Use strict tsconfig.json template; validate during init |
| **Theme customization takes too long** | ðŸŸ¡ Medium | Use preset defaults initially; defer advanced theming to Phase 4 |

---

## Success Criteria (Acceptance)

All items from Feature Spec must be achievable:

- âœ… **SC-001**: Developer initializes project in <10 min
- âœ… **SC-004**: Lighthouse Performance â‰¥90
- âœ… **SC-005**: Page load <3 seconds (4G simulation)
- âœ… **SC-006**: Mobile responsive (320px viewport)
- âœ… **SC-010**: GitHub Actions 100% success rate
- âœ… **SC-011**: No secrets in code/logs
- âœ… **SC-013**: Cross-browser compatible (Chrome, Firefox, Safari, Edge)

---

## Definition of Done (Phase 1)

This phase is complete when:

- âœ… Docusaurus 3.x project initializes with TypeScript + pnpm
- âœ… Local dev server runs with hot-reload
- âœ… Static build completes without errors
- âœ… Theme configured (dark/light mode works)
- âœ… Sidebar shows 4 modules with placeholder lessons
- âœ… Search plugin functional
- âœ… Sitemap.xml generated on build
- âœ… GitHub Actions workflow deployed
- âœ… GitHub Pages site live at GitHub URL
- âœ… Lighthouse Performance â‰¥90
- âœ… Mobile responsive verified
- âœ… No hardcoded secrets in repo
- âœ… quickstart.md documented for Phase 2 developers
- âœ… All tests in spec.md passing

---

## Next Steps

1. âœ… **Specification created** (`spec.md`)
2. âœ… **Plan created** (this file - `plan.md`)
3. **â†’ Run `/sp.tasks`** to generate detailed task breakdown (`tasks.md`)
4. **â†’ Begin implementation** following tasks (Phase 1: 4-5 hours)
5. **â†’ Validate deployment** before Phase 2 content creation
6. **â†’ Create PHR** documenting decisions made during implementation

---

## References

- [Docusaurus 3.x Official Docs](https://docusaurus.io/docs)
- [GitHub Actions Setup](https://docs.github.com/en/actions)
- [Docusaurus Preset Classic](https://docusaurus.io/docs/installation#project-structure)
- [pnpm Documentation](https://pnpm.io/)

---

**Status**: âœ… Ready for `/sp.tasks` phase
