"use strict";(self.webpackChunkphysical_ai_robotics_textbook=self.webpackChunkphysical_ai_robotics_textbook||[]).push([[508],{5921:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"chapter-1-ros2-fundamentals/first-publisher","title":"Your First Publisher","description":"Introduction","source":"@site/docs/chapter-1-ros2-fundamentals/03-first-publisher.md","sourceDirName":"chapter-1-ros2-fundamentals","slug":"/chapter-1-ros2-fundamentals/first-publisher","permalink":"/physical-ai-robotics-textbook/docs/chapter-1-ros2-fundamentals/first-publisher","draft":false,"unlisted":false,"editUrl":"https://github.com/devhammad0/physical-ai-robotics-textbook/tree/main/docs/chapter-1-ros2-fundamentals/03-first-publisher.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"title":"Your First Publisher","sidebar_position":3,"sidebar_label":"3. First Publisher","chapter":1,"lesson":3,"lesson_slug":"first-publisher","duration_minutes":60,"estimated_difficulty":"beginner","simulation_required":["turtlesim"],"safety_level":"simulation_only","cefr_level":"A2","hardware_prerequisites":[],"concepts":["rclpy library","Node class","create_publisher()","Timer and callbacks","Message creation","Logging","Node lifecycle"],"primary_layer":"Layer 2","learning_objectives":["Create a ROS 2 node in Python using rclpy","Create a publisher that sends messages to a topic","Use timers for periodic execution","Send Twist messages to move Turtlesim","Verify publisher is working with ros2 topic echo","Debug common publisher issues"],"assessment_type":"practical_exercise","keywords":["ROS 2","Python","rclpy","publisher","Twist","timer","geometry_msgs","Turtlesim"]},"sidebar":"tutorialSidebar","previous":{"title":"2. Setup Environment","permalink":"/physical-ai-robotics-textbook/docs/chapter-1-ros2-fundamentals/setup-environment"},"next":{"title":"4. Debugging ROS 2","permalink":"/physical-ai-robotics-textbook/docs/chapter-1-ros2-fundamentals/debugging-ros2"}}');var i=n(6070),l=n(8439);const t={title:"Your First Publisher",sidebar_position:3,sidebar_label:"3. First Publisher",chapter:1,lesson:3,lesson_slug:"first-publisher",duration_minutes:60,estimated_difficulty:"beginner",simulation_required:["turtlesim"],safety_level:"simulation_only",cefr_level:"A2",hardware_prerequisites:[],concepts:["rclpy library","Node class","create_publisher()","Timer and callbacks","Message creation","Logging","Node lifecycle"],primary_layer:"Layer 2",learning_objectives:["Create a ROS 2 node in Python using rclpy","Create a publisher that sends messages to a topic","Use timers for periodic execution","Send Twist messages to move Turtlesim","Verify publisher is working with ros2 topic echo","Debug common publisher issues"],assessment_type:"practical_exercise",keywords:["ROS 2","Python","rclpy","publisher","Twist","timer","geometry_msgs","Turtlesim"]},o="Your First Publisher",d={},a=[{value:"Introduction",id:"introduction",level:2},{value:"Understanding Publishers: The Theory",id:"understanding-publishers-the-theory",level:2},{value:"Publisher Role",id:"publisher-role",level:3},{value:"Key Elements of a Publisher Node",id:"key-elements-of-a-publisher-node",level:3},{value:"Layer 2: Creating Your First Publisher Node",id:"layer-2-creating-your-first-publisher-node",level:2},{value:"Step 1: Create a File",id:"step-1-create-a-file",level:3},{value:"Step 2: Write the Publisher Code",id:"step-2-write-the-publisher-code",level:3},{value:"Step 3: Understand the Code",id:"step-3-understand-the-code",level:3},{value:"Step 4: Run the Publisher",id:"step-4-run-the-publisher",level:2},{value:"\ud83d\udcac AI CoLearning: Understanding Message Types",id:"-ai-colearning-understanding-message-types",level:2},{value:"Experiment: Modify the Publisher",id:"experiment-modify-the-publisher",level:2},{value:"Experiment 1: Make the Turtle Faster",id:"experiment-1-make-the-turtle-faster",level:3},{value:"Experiment 2: Make the Turtle Rotate",id:"experiment-2-make-the-turtle-rotate",level:3},{value:"Experiment 3: Move in a Square",id:"experiment-3-move-in-a-square",level:3},{value:"Verifying Your Publisher with <code>ros2 topic echo</code>",id:"verifying-your-publisher-with-ros2-topic-echo",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Error: &quot;ModuleNotFoundError: No module named &#39;geometry_msgs&#39;&quot;",id:"error-modulenotfounderror-no-module-named-geometry_msgs",level:3},{value:"Error: &quot;Cannot find node named &#39;/turtlesim&#39;&quot;",id:"error-cannot-find-node-named-turtlesim",level:3},{value:"Error: &quot;rclpy.init() called twice&quot;",id:"error-rclpyinit-called-twice",level:3},{value:"Error: &quot;Turtle doesn&#39;t move&quot;",id:"error-turtle-doesnt-move",level:3},{value:"Turtle Moves But Doesn&#39;t Stop",id:"turtle-moves-but-doesnt-stop",level:3},{value:"\ud83e\udd1d Collaboration Exercise: Debug This!",id:"-collaboration-exercise-debug-this",level:2},{value:"Self-Assessment",id:"self-assessment",level:2},{value:"What&#39;s Next?",id:"whats-next",level:2},{value:"Additional Resources",id:"additional-resources",level:2}];function c(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"your-first-publisher",children:"Your First Publisher"})}),"\n",(0,i.jsx)(s.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsxs)(s.p,{children:["Time to write code! In Lesson 2, you explored ROS 2 from the command line. Now you'll write a ",(0,i.jsx)(s.strong,{children:"Python node that publishes messages"}),"."]}),"\n",(0,i.jsx)(s.p,{children:"Your goal: Write a program that sends movement commands to Turtlesim automatically, making the turtle move without manual commands."}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"What you'll build"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"class TurtleCommandPublisher(Node):\n    # Publishes motion commands\n    # Timer fires every 0.5 seconds\n    # Turtle moves forward, then stops\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"understanding-publishers-the-theory",children:"Understanding Publishers: The Theory"}),"\n",(0,i.jsx)(s.p,{children:"Before you code, let's review what a publisher does."}),"\n",(0,i.jsx)(s.h3,{id:"publisher-role",children:"Publisher Role"}),"\n",(0,i.jsxs)(s.p,{children:["A ",(0,i.jsx)(s.strong,{children:"publisher"})," is a node that sends messages to a topic."]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:'Your Code (Publisher)\n    \u2193 sends message "move forward"\n    \u2193\nTopic: /turtle1/cmd_vel\n    \u2193 subscribers listen here\n    \u2193\nTurtlesim (Subscriber) receives message \u2192 moves turtle\n'})}),"\n",(0,i.jsx)(s.h3,{id:"key-elements-of-a-publisher-node",children:"Key Elements of a Publisher Node"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Import rclpy"})," \u2014 Python library for ROS 2"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Create a Node subclass"})," \u2014 Your code inherits from ",(0,i.jsx)(s.code,{children:"rclpy.node.Node"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Create a publisher"})," \u2014 ",(0,i.jsx)(s.code,{children:"self.create_publisher(MessageType, '/topic/name', queue_size)"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Create a timer"})," \u2014 For periodic execution (not required, but common)"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Implement timer callback"})," \u2014 Function that publishes messages"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Initialize rclpy"})," \u2014 ",(0,i.jsx)(s.code,{children:"rclpy.init()"})," before creating nodes"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Spin the node"})," \u2014 ",(0,i.jsx)(s.code,{children:"rclpy.spin(node)"})," to keep it running"]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"layer-2-creating-your-first-publisher-node",children:"Layer 2: Creating Your First Publisher Node"}),"\n",(0,i.jsx)(s.h3,{id:"step-1-create-a-file",children:"Step 1: Create a File"}),"\n",(0,i.jsxs)(s.p,{children:["Create a new file called ",(0,i.jsx)(s.code,{children:"publisher_node.py"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"touch ~/publisher_node.py\n"})}),"\n",(0,i.jsx)(s.p,{children:"Open it in your text editor (VS Code, nano, vim, etc.)."}),"\n",(0,i.jsx)(s.h3,{id:"step-2-write-the-publisher-code",children:"Step 2: Write the Publisher Code"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Type this code carefully"})," (don't copy-paste\u2014typing builds muscle memory):"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import Twist\n\n\nclass TurtleCommandPublisher(Node):\n    def __init__(self):\n        super().__init__('turtle_command_publisher')\n\n        # Create a publisher that sends Twist messages to /turtle1/cmd_vel\n        # queue_size=10 means buffer up to 10 messages if subscribers are slow\n        self.publisher_ = self.create_publisher(Twist, '/turtle1/cmd_vel', 10)\n\n        # Create a timer that calls timer_callback every 0.5 seconds\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n\n        # Counter to track how many times we've published\n        self.counter = 0\n\n    def timer_callback(self):\n        \"\"\"Called every 0.5 seconds by the timer\"\"\"\n\n        # Create a Twist message (velocity command for the turtle)\n        msg = Twist()\n        msg.linear.x = 1.0   # Move forward at 1 m/s\n        msg.angular.z = 0.0  # Don't rotate\n\n        # Publish the message\n        self.publisher_.publish(msg)\n\n        # Log what we published (for debugging)\n        self.get_logger().info(f'Publishing: linear.x={msg.linear.x}')\n\n        # Increment counter\n        self.counter += 1\n\n        # Stop after 5 publishes (2.5 seconds total)\n        if self.counter >= 5:\n            # Send a stop command\n            stop_msg = Twist()\n            stop_msg.linear.x = 0.0\n            stop_msg.angular.z = 0.0\n            self.publisher_.publish(stop_msg)\n\n            # Log and shutdown\n            self.get_logger().info('Turtle stopped. Shutting down.')\n            rclpy.shutdown()\n\n\ndef main(args=None):\n    \"\"\"Entry point for the ROS 2 node\"\"\"\n\n    # Initialize ROS 2 (must be called before creating nodes)\n    rclpy.init(args=args)\n\n    # Create an instance of our publisher node\n    node = TurtleCommandPublisher()\n\n    # Run the node (this blocks until rclpy.shutdown() is called)\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        # Clean up\n        node.destroy_node()\n        rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(s.h3,{id:"step-3-understand-the-code",children:"Step 3: Understand the Code"}),"\n",(0,i.jsx)(s.p,{children:"Let me break down each section:"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Imports"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import rclpy                           # ROS 2 Python library\nfrom rclpy.node import Node            # Base class for nodes\nfrom geometry_msgs.msg import Twist    # Message type for velocity commands\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Class Definition"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"class TurtleCommandPublisher(Node):    # Inherit from Node\n    def __init__(self):                # Constructor\n        super().__init__('turtle_command_publisher')  # Set node name\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Publisher Creation"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"self.publisher_ = self.create_publisher(\n    Twist,                # Message type\n    '/turtle1/cmd_vel',   # Topic name\n    10                    # Queue size\n)\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Timer Creation"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"self.timer = self.create_timer(\n    0.5,                      # Call every 0.5 seconds\n    self.timer_callback       # Function to call\n)\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Callback Function"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"def timer_callback(self):\n    # Called every 0.5 seconds\n    msg = Twist()\n    msg.linear.x = 1.0      # Set forward velocity\n    self.publisher_.publish(msg)  # Send it\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Main Function"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"def main(args=None):\n    rclpy.init(args=args)     # Initialize ROS 2\n    node = TurtleCommandPublisher()  # Create node\n    rclpy.spin(node)          # Run the node\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"step-4-run-the-publisher",children:"Step 4: Run the Publisher"}),"\n",(0,i.jsx)(s.p,{children:"Make sure:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Terminal 1"}),": Turtlesim running (",(0,i.jsx)(s.code,{children:"ros2 run turtlesim turtlesim_node"}),")"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Terminal 2"}),": Your publisher node"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"In Terminal 2, run:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"cd ~\npython3 publisher_node.py\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Expected output"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"[INFO] [turtle_command_publisher]: Publishing: linear.x=1.0\n[INFO] [turtle_command_publisher]: Publishing: linear.x=1.0\n[INFO] [turtle_command_publisher]: Publishing: linear.x=1.0\n[INFO] [turtle_command_publisher]: Publishing: linear.x=1.0\n[INFO] [turtle_command_publisher]: Publishing: linear.x=1.0\n[INFO] [turtle_command_publisher]: Turtle stopped. Shutting down.\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"In Terminal 1"})," (Turtlesim window):"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Turtle should ",(0,i.jsx)(s.strong,{children:"move forward for ~2.5 seconds"}),", then ",(0,i.jsx)(s.strong,{children:"stop"})]}),"\n",(0,i.jsx)(s.li,{children:"You should see a pen trail (default: turtle draws as it moves)"}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"-ai-colearning-understanding-message-types",children:"\ud83d\udcac AI CoLearning: Understanding Message Types"}),"\n",(0,i.jsxs)(s.p,{children:["Your code used ",(0,i.jsx)(s.code,{children:"Twist"})," message type. This is important!"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Ask Claude"}),":"]}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:'"What\'s inside a Twist message? What fields does it have?"'}),"\n",(0,i.jsxs)(s.li,{children:['"Why do we need to set ',(0,i.jsx)(s.code,{children:"msg.linear.x"})," instead of just ",(0,i.jsx)(s.code,{children:"msg = Twist(1.0, 0.0)"}),'?"']}),"\n",(0,i.jsxs)(s.li,{children:['"What would happen if I set ',(0,i.jsx)(s.code,{children:"msg.angular.z = 1.0"}),' instead?"']}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Expected answers"}),":"]}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["Twist has ",(0,i.jsx)(s.code,{children:"linear"})," (x, y, z velocity) and ",(0,i.jsx)(s.code,{children:"angular"})," (x, y, z rotation)"]}),"\n",(0,i.jsx)(s.li,{children:"Twist is a structured message with named fields; we set them by name"}),"\n",(0,i.jsx)(s.li,{children:"The turtle would rotate instead of move forward"}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["This teaches you about ",(0,i.jsx)(s.strong,{children:"message structures"}),"\u2014the key to ROS 2 communication."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"experiment-modify-the-publisher",children:"Experiment: Modify the Publisher"}),"\n",(0,i.jsxs)(s.p,{children:["Now that you have a working publisher, ",(0,i.jsx)(s.strong,{children:"modify it"}),":"]}),"\n",(0,i.jsx)(s.h3,{id:"experiment-1-make-the-turtle-faster",children:"Experiment 1: Make the Turtle Faster"}),"\n",(0,i.jsx)(s.p,{children:"Change this line:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"msg.linear.x = 1.0   # Change to 2.0\n"})}),"\n",(0,i.jsx)(s.p,{children:"To:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"msg.linear.x = 2.0   # Move faster\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Run again. The turtle should move ",(0,i.jsx)(s.strong,{children:"faster"}),"."]}),"\n",(0,i.jsx)(s.h3,{id:"experiment-2-make-the-turtle-rotate",children:"Experiment 2: Make the Turtle Rotate"}),"\n",(0,i.jsx)(s.p,{children:"Change:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"msg.linear.x = 1.0\nmsg.angular.z = 0.0\n"})}),"\n",(0,i.jsx)(s.p,{children:"To:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"msg.linear.x = 0.0      # Don't move forward\nmsg.angular.z = 1.0     # Rotate at 1 rad/s\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Run again. The turtle should ",(0,i.jsx)(s.strong,{children:"spin in place"}),"."]}),"\n",(0,i.jsx)(s.h3,{id:"experiment-3-move-in-a-square",children:"Experiment 3: Move in a Square"}),"\n",(0,i.jsxs)(s.p,{children:["Modify ",(0,i.jsx)(s.code,{children:"timer_callback"})," to alternate between moving and rotating:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"def timer_callback(self):\n    msg = Twist()\n\n    # Alternate: move forward, then rotate\n    if self.counter % 2 == 0:\n        msg.linear.x = 1.0   # Move forward\n        msg.angular.z = 0.0\n    else:\n        msg.linear.x = 0.0\n        msg.angular.z = 0.5  # Rotate\n\n    self.publisher_.publish(msg)\n    self.counter += 1\n\n    if self.counter >= 20:\n        # Stop\n        stop_msg = Twist()\n        self.publisher_.publish(stop_msg)\n        rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(s.p,{children:"Run again. The turtle should move forward, rotate, move forward, rotate, etc."}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsxs)(s.h2,{id:"verifying-your-publisher-with-ros2-topic-echo",children:["Verifying Your Publisher with ",(0,i.jsx)(s.code,{children:"ros2 topic echo"})]}),"\n",(0,i.jsxs)(s.p,{children:["While your publisher is running, open a ",(0,i.jsx)(s.strong,{children:"third terminal"})," and watch the topic:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ros2 topic echo /turtle1/cmd_vel\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Expected output"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"linear:\n  x: 1.0\n  y: 0.0\n  z: 0.0\nangular:\n  x: 0.0\n  y: 0.0\n  z: 0.0\n---\nlinear:\n  x: 1.0\n  y: 0.0\n  z: 0.0\nangular:\n  x: 0.0\n  y: 0.0\n  z: 0.0\n---\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Each ",(0,i.jsx)(s.code,{children:"---"})," separator shows a new message. You should see one message every 0.5 seconds (matching your timer)."]}),"\n",(0,i.jsxs)(s.p,{children:["This ",(0,i.jsx)(s.strong,{children:"proves"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Your publisher is sending messages \u2705"}),"\n",(0,i.jsx)(s.li,{children:"The messages are correct (linear.x = 1.0) \u2705"}),"\n",(0,i.jsx)(s.li,{children:"Turtlesim is receiving them (turtle moves) \u2705"}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsx)(s.h3,{id:"error-modulenotfounderror-no-module-named-geometry_msgs",children:"Error: \"ModuleNotFoundError: No module named 'geometry_msgs'\""}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Cause"}),": geometry_msgs not installed"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo apt install ros-humble-geometry-msgs\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"error-cannot-find-node-named-turtlesim",children:"Error: \"Cannot find node named '/turtlesim'\""}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Cause"}),": Turtlesim not running"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Open Terminal 1 and run: ",(0,i.jsx)(s.code,{children:"ros2 run turtlesim turtlesim_node"})]}),"\n",(0,i.jsx)(s.li,{children:"Then run your publisher in Terminal 2"}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"error-rclpyinit-called-twice",children:'Error: "rclpy.init() called twice"'}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Cause"}),": You ran the publisher multiple times in the same Python process"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Solution"}),":"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["This shouldn't happen unless you're importing the module. Just run the script cleanly: ",(0,i.jsx)(s.code,{children:"python3 publisher_node.py"})]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"error-turtle-doesnt-move",children:'Error: "Turtle doesn\'t move"'}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Diagnosis steps"}),":"]}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Is Turtlesim running?"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ros2 node list  # Should show /turtlesim\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Is your publisher running?"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ros2 node list  # Should show /turtle_command_publisher\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Are messages being published?"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ros2 topic echo /turtle1/cmd_vel  # Should show Twist messages\n"})}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Is the topic name correct?"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"ros2 topic list  # Should show /turtle1/cmd_vel\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"If all checks pass and turtle still doesn't move, the issue might be a message value. Try running the manual command from Lesson 2:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:'ros2 topic pub /turtle1/cmd_vel geometry_msgs/msg/Twist "linear: {x: 1.0}"\n'})}),"\n",(0,i.jsxs)(s.p,{children:["If the turtle moves with this command but not with your publisher, the message structure might be wrong. Compare your ",(0,i.jsx)(s.code,{children:"Twist()"})," creation to the manual command above."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"turtle-moves-but-doesnt-stop",children:"Turtle Moves But Doesn't Stop"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Cause"}),": Your code might not have reached the ",(0,i.jsx)(s.code,{children:"if self.counter >= 5"})," stop condition"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Solution"}),": Press ",(0,i.jsx)(s.code,{children:"Ctrl+C"})," to stop the node, or add a print statement to debug:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"self.get_logger().info(f'Counter: {self.counter}')  # Add this line\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"-collaboration-exercise-debug-this",children:"\ud83e\udd1d Collaboration Exercise: Debug This!"}),"\n",(0,i.jsx)(s.p,{children:"Here's intentionally broken code. Use the diagnostic tools above to find the problem and fix it:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"# \u274c BROKEN CODE (intentionally)\nimport rclpy\nfrom rclpy.node import Node\nfrom geometry_msgs.msg import Twist\n\nclass BrokenPublisher(Node):\n    def __init__(self):\n        super().__init__('broken_publisher')\n        self.publisher_ = self.create_publisher(Twist, '/turtle1/cmd_vel', 10)\n        # MISSING: self.timer = self.create_timer(...)\n        self.counter = 0\n\n    def timer_callback(self):\n        msg = Twist()\n        msg.linear.x = 1.0\n        self.publisher_.publish(msg)\n        self.counter += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = BrokenPublisher()\n    rclpy.spin(node)\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Your task"}),":"]}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:"Run this code (even though it's broken)"}),"\n",(0,i.jsxs)(s.li,{children:["Use ",(0,i.jsx)(s.code,{children:"ros2 topic echo /turtle1/cmd_vel"})," to check if messages are published"]}),"\n",(0,i.jsxs)(s.li,{children:["Use ",(0,i.jsx)(s.code,{children:"ros2 node list"})," to verify the node exists"]}),"\n",(0,i.jsx)(s.li,{children:"Figure out what's wrong"}),"\n",(0,i.jsx)(s.li,{children:"Ask Claude for a hint if stuck"}),"\n",(0,i.jsx)(s.li,{children:"Fix the code"}),"\n",(0,i.jsx)(s.li,{children:"Verify it works"}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"What's wrong?"})," The timer is never created, so ",(0,i.jsx)(s.code,{children:"timer_callback"})," is never called. Fix: Add ",(0,i.jsx)(s.code,{children:"self.timer = self.create_timer(0.5, self.timer_callback)"})," to ",(0,i.jsx)(s.code,{children:"__init__"}),"."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"self-assessment",children:"Self-Assessment"}),"\n",(0,i.jsx)(s.p,{children:"Before moving to Lesson 4, verify:"}),"\n",(0,i.jsxs)(s.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Created ",(0,i.jsx)(s.code,{children:"publisher_node.py"})," with working code"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Node publishes Twist messages to ",(0,i.jsx)(s.code,{children:"/turtle1/cmd_vel"})]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Turtlesim turtle moves when you run the publisher"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Turtle stops after 5 messages (or when node shuts down)"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Can see messages with ",(0,i.jsx)(s.code,{children:"ros2 topic echo /turtle1/cmd_vel"})]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Modified publisher to change speed/rotation and verified changes worked"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Understood what ",(0,i.jsx)(s.code,{children:"Twist"})," message contains"]}),"\n",(0,i.jsxs)(s.li,{className:"task-list-item",children:[(0,i.jsx)(s.input,{type:"checkbox",disabled:!0})," ","Debugged the intentionally broken code"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["If all checkboxes pass, ",(0,i.jsx)(s.strong,{children:"you're ready for Lesson 4: Debugging"}),"."]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"whats-next",children:"What's Next?"}),"\n",(0,i.jsxs)(s.p,{children:["Lesson 4 teaches ",(0,i.jsx)(s.strong,{children:"debugging"}),"\u2014what to do when things break (and they will). You'll:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Learn the diagnostic toolkit (ros2 topic, ros2 node, logging)"}),"\n",(0,i.jsx)(s.li,{children:"Work with Claude to troubleshoot broken code"}),"\n",(0,i.jsx)(s.li,{children:"Develop a systematic debugging mindset"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"/physical-ai-robotics-textbook/docs/chapter-1-ros2-fundamentals/debugging-ros2",children:"\u2192 Lesson 4: Debugging ROS 2 Systems"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"additional-resources",children:"Additional Resources"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Py-Publisher-And-Subscriber.html",children:"ROS 2 Creating a Simple Publisher"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"https://docs.ros2.org/latest/api/geometry_msgs/msg/Twist.html",children:"Twist Message Documentation"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"https://docs.ros2.org/latest/api/rclpy/api/node.html",children:"rclpy Node API"})}),"\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.a,{href:"https://docs.ros2.org/latest/api/rclpy/api/node.html#rclpy.node.Node.create_timer",children:"rclpy Timers"})}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8439:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>o});var r=n(758);const i={},l=r.createContext(i);function t(e){const s=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),r.createElement(l.Provider,{value:s},e.children)}}}]);